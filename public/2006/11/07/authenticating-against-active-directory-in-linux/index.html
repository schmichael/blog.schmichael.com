<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Authenticating Against Active Directory in Linux</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.15" />
  <link href="" rel="alternate" type="application/rss+xml" title="schmichael&#39;s blog" />
  <link href="https://blog.schmichael.com//css/bootstrap.min.css" rel="stylesheet">
  <link href="https://blog.schmichael.com//css/hc.css" rel="stylesheet">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  
    
    </head>
    <body>
<div class="nav-toggle"><i class="fa fa-bars fa-2x"></i> Herring Cove </div>
      <div id = "wrapper">


<div class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="https://blog.schmichael.com//"><p class="navbar-brand">schmichael&#39;s blog</p></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
					
					
					<li><a href="https://blog.schmichael.com//blog/">Blog </a></li>
					
					<li><a href="https://blog.schmichael.com//about-me/">About </a></li>
					
					<li><a href="https://blog.schmichael.com//">Home </a></li>
					
          </ul>
        </div>
      </div>
    </div>



       
       <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
					<img src="" />
          <li class="sidebar-brand"><a href="https://blog.schmichael.com//"><h1 class="brand">schmichael&#39;s blog</h1></a><h3></h3></li>
          <hr />
					
						<li><a href="https://blog.schmichael.com//about-me/">About </a></li>
					
						<li><a href="https://blog.schmichael.com//">Home </a></li>
					
						<li><a href="https://blog.schmichael.com//blog/">Blog </a></li>
					
          <hr />
          <div id="social-wrapper">
           
           
           
           
         </div>
       </ul>
     </div>



     <div class="container">


  <div id="article">
   <div class="article-title">Authenticating Against Active Directory in Linux</div>
   <p class="meta"><small>&nbsp;<i class="fa fa-calendar-o"></i> 2006-11-07</small></p> <hr/>
   <div class="post">
     

<p>I finally got it. After about 5 hours of working on it, I&#8217;ve finally gotten <strong>Linux to authenticate against Active Directory on a Windows 2000 Server</strong>. I want to post how I have it configured because it seems like most documentation only takes you halfway.</p>

<p>Software used: <a href="http://www.us.debian.org/"><span style="font-weight: bold">Debian</span> Etch</a>, <a href="http://samba.org"><span style="font-weight: bold">Samba</span> 3.0.23c with <span style="font-weight: bold">Winbind</span> and pam_winbind</a>, and <a href="http://web.mit.edu/Kerberos/"><span style="font-weight: bold">MIT Kerberos</span> with pam_libkrb5</a>.</p>

<p>The first step after getting the prerequisite software installed is to <span style="font-weight: bold">join the domain</span>. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically <span class="sect2"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601">On-the-Fly Creation of Machine Trust Accounts</a> and </span><span class="sect1"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member">Samba ADS Domain Membership</a>.</span></p>

<p>The next step is to hook Linux&#8217;s authentication (<a href="http://www.kernel.org/pub/linux/libs/pam/">PAM</a>) into Active Directory. Here are the relevant bits of my configuration files:</p>

<p><span style="font-weight: bold">NOTE:</span> In the following examples <span style="font-weight: bold">TREMONT</span> is the domain, <span style="font-weight: bold">TREMONT.LOCAL</span> is the realm, and <span style="font-weight: bold">thsdc1</span> is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).</p>

<p><span style="font-weight: bold">/etc/samba/smb.conf</span> (relevant bits only)</p>

<p>`[global]<br /></p>

<h1 id="domain-workgroup-tremont-realm-tremont-local-security-ads-add-machine-script-usr-sbin-useradd-d-var-lib-nobody-g-100-s-bin-false-m-u-br:591e5c02e74acd24649da083f0a88d90">Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u<br /></h1>

<p>encrypt passwords = true<br /></p>

<h2 id="commented-the-following-out-but-i-don-t-know-if-its-necessary-br:591e5c02e74acd24649da083f0a88d90">Commented the following out, but I don&rsquo;t know if its necessary<br /></h2>

<h1 id="passdb-backend-tdbsam-br:591e5c02e74acd24649da083f0a88d90">passdb backend = tdbsam<br /></h1>

<p>obey pam restrictions = yes<br />
idmap uid = 10000-20000<br />
idmap gid = 10000-20000<br />
template shell = /bin/bash<br /></p>

<h1 id="note-i-do-not-use-the-separator-username-format-domain-user-br:591e5c02e74acd24649da083f0a88d90">Note: I do <em>not</em> use the separator username format: Domain\User<br /></h1>

<p>#winbind separator = &lsquo;\&rsquo;<br /></p>

<h1 id="the-following-allows-users-to-login-with-just-username-br:591e5c02e74acd24649da083f0a88d90">The following allows users to login with just Username<br /></h1>

<p>winbind use default domain = yes<br />
winbind enum users = yes<br />
winbind enum groups = ye template homedir = /home/%D/%U`</p>

<p><span style="font-weight: bold">/etc/krb5.conf</span> (from the <span style="font-style: italic">krb5-config</span> package)</p>

<p>``I finally got it. After about 5 hours of working on it, I&#8217;ve finally gotten <strong>Linux to authenticate against Active Directory on a Windows 2000 Server</strong>. I want to post how I have it configured because it seems like most documentation only takes you halfway.</p>

<p>Software used: <a href="http://www.us.debian.org/"><span style="font-weight: bold">Debian</span> Etch</a>, <a href="http://samba.org"><span style="font-weight: bold">Samba</span> 3.0.23c with <span style="font-weight: bold">Winbind</span> and pam_winbind</a>, and <a href="http://web.mit.edu/Kerberos/"><span style="font-weight: bold">MIT Kerberos</span> with pam_libkrb5</a>.</p>

<p>The first step after getting the prerequisite software installed is to <span style="font-weight: bold">join the domain</span>. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically <span class="sect2"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601">On-the-Fly Creation of Machine Trust Accounts</a> and </span><span class="sect1"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member">Samba ADS Domain Membership</a>.</span></p>

<p>The next step is to hook Linux&#8217;s authentication (<a href="http://www.kernel.org/pub/linux/libs/pam/">PAM</a>) into Active Directory. Here are the relevant bits of my configuration files:</p>

<p><span style="font-weight: bold">NOTE:</span> In the following examples <span style="font-weight: bold">TREMONT</span> is the domain, <span style="font-weight: bold">TREMONT.LOCAL</span> is the realm, and <span style="font-weight: bold">thsdc1</span> is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).</p>

<p><span style="font-weight: bold">/etc/samba/smb.conf</span> (relevant bits only)</p>

<p>`[global]<br /></p>

<h1 id="domain-workgroup-tremont-realm-tremont-local-security-ads-add-machine-script-usr-sbin-useradd-d-var-lib-nobody-g-100-s-bin-false-m-u-br-1:591e5c02e74acd24649da083f0a88d90">Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u<br /></h1>

<p>encrypt passwords = true<br /></p>

<h2 id="commented-the-following-out-but-i-don-t-know-if-its-necessary-br-1:591e5c02e74acd24649da083f0a88d90">Commented the following out, but I don&rsquo;t know if its necessary<br /></h2>

<h1 id="passdb-backend-tdbsam-br-1:591e5c02e74acd24649da083f0a88d90">passdb backend = tdbsam<br /></h1>

<p>obey pam restrictions = yes<br />
idmap uid = 10000-20000<br />
idmap gid = 10000-20000<br />
template shell = /bin/bash<br /></p>

<h1 id="note-i-do-not-use-the-separator-username-format-domain-user-br-1:591e5c02e74acd24649da083f0a88d90">Note: I do <em>not</em> use the separator username format: Domain\User<br /></h1>

<p>#winbind separator = &lsquo;\&rsquo;<br /></p>

<h1 id="the-following-allows-users-to-login-with-just-username-br-1:591e5c02e74acd24649da083f0a88d90">The following allows users to login with just Username<br /></h1>

<p>winbind use default domain = yes<br />
winbind enum users = yes<br />
winbind enum groups = ye template homedir = /home/%D/%U`</p>

<p><span style="font-weight: bold">/etc/krb5.conf</span> (from the <span style="font-style: italic">krb5-config</span> package)</p>

<p>``</p>

<p><span style="font-weight: bold">/etc/pam.d/common-auth</span></p>

<p>```I finally got it. After about 5 hours of working on it, I&#8217;ve finally gotten <strong>Linux to authenticate against Active Directory on a Windows 2000 Server</strong>. I want to post how I have it configured because it seems like most documentation only takes you halfway.</p>

<p>Software used: <a href="http://www.us.debian.org/"><span style="font-weight: bold">Debian</span> Etch</a>, <a href="http://samba.org"><span style="font-weight: bold">Samba</span> 3.0.23c with <span style="font-weight: bold">Winbind</span> and pam_winbind</a>, and <a href="http://web.mit.edu/Kerberos/"><span style="font-weight: bold">MIT Kerberos</span> with pam_libkrb5</a>.</p>

<p>The first step after getting the prerequisite software installed is to <span style="font-weight: bold">join the domain</span>. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically <span class="sect2"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601">On-the-Fly Creation of Machine Trust Accounts</a> and </span><span class="sect1"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member">Samba ADS Domain Membership</a>.</span></p>

<p>The next step is to hook Linux&#8217;s authentication (<a href="http://www.kernel.org/pub/linux/libs/pam/">PAM</a>) into Active Directory. Here are the relevant bits of my configuration files:</p>

<p><span style="font-weight: bold">NOTE:</span> In the following examples <span style="font-weight: bold">TREMONT</span> is the domain, <span style="font-weight: bold">TREMONT.LOCAL</span> is the realm, and <span style="font-weight: bold">thsdc1</span> is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).</p>

<p><span style="font-weight: bold">/etc/samba/smb.conf</span> (relevant bits only)</p>

<p>`[global]<br /></p>

<h1 id="domain-workgroup-tremont-realm-tremont-local-security-ads-add-machine-script-usr-sbin-useradd-d-var-lib-nobody-g-100-s-bin-false-m-u-br-2:591e5c02e74acd24649da083f0a88d90">Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u<br /></h1>

<p>encrypt passwords = true<br /></p>

<h2 id="commented-the-following-out-but-i-don-t-know-if-its-necessary-br-2:591e5c02e74acd24649da083f0a88d90">Commented the following out, but I don&rsquo;t know if its necessary<br /></h2>

<h1 id="passdb-backend-tdbsam-br-2:591e5c02e74acd24649da083f0a88d90">passdb backend = tdbsam<br /></h1>

<p>obey pam restrictions = yes<br />
idmap uid = 10000-20000<br />
idmap gid = 10000-20000<br />
template shell = /bin/bash<br /></p>

<h1 id="note-i-do-not-use-the-separator-username-format-domain-user-br-2:591e5c02e74acd24649da083f0a88d90">Note: I do <em>not</em> use the separator username format: Domain\User<br /></h1>

<p>#winbind separator = &lsquo;\&rsquo;<br /></p>

<h1 id="the-following-allows-users-to-login-with-just-username-br-2:591e5c02e74acd24649da083f0a88d90">The following allows users to login with just Username<br /></h1>

<p>winbind use default domain = yes<br />
winbind enum users = yes<br />
winbind enum groups = ye template homedir = /home/%D/%U`</p>

<p><span style="font-weight: bold">/etc/krb5.conf</span> (from the <span style="font-style: italic">krb5-config</span> package)</p>

<p>``I finally got it. After about 5 hours of working on it, I&#8217;ve finally gotten <strong>Linux to authenticate against Active Directory on a Windows 2000 Server</strong>. I want to post how I have it configured because it seems like most documentation only takes you halfway.</p>

<p>Software used: <a href="http://www.us.debian.org/"><span style="font-weight: bold">Debian</span> Etch</a>, <a href="http://samba.org"><span style="font-weight: bold">Samba</span> 3.0.23c with <span style="font-weight: bold">Winbind</span> and pam_winbind</a>, and <a href="http://web.mit.edu/Kerberos/"><span style="font-weight: bold">MIT Kerberos</span> with pam_libkrb5</a>.</p>

<p>The first step after getting the prerequisite software installed is to <span style="font-weight: bold">join the domain</span>. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically <span class="sect2"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601">On-the-Fly Creation of Machine Trust Accounts</a> and </span><span class="sect1"><a href="http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member">Samba ADS Domain Membership</a>.</span></p>

<p>The next step is to hook Linux&#8217;s authentication (<a href="http://www.kernel.org/pub/linux/libs/pam/">PAM</a>) into Active Directory. Here are the relevant bits of my configuration files:</p>

<p><span style="font-weight: bold">NOTE:</span> In the following examples <span style="font-weight: bold">TREMONT</span> is the domain, <span style="font-weight: bold">TREMONT.LOCAL</span> is the realm, and <span style="font-weight: bold">thsdc1</span> is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).</p>

<p><span style="font-weight: bold">/etc/samba/smb.conf</span> (relevant bits only)</p>

<p>`[global]<br /></p>

<h1 id="domain-workgroup-tremont-realm-tremont-local-security-ads-add-machine-script-usr-sbin-useradd-d-var-lib-nobody-g-100-s-bin-false-m-u-br-3:591e5c02e74acd24649da083f0a88d90">Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u<br /></h1>

<p>encrypt passwords = true<br /></p>

<h2 id="commented-the-following-out-but-i-don-t-know-if-its-necessary-br-3:591e5c02e74acd24649da083f0a88d90">Commented the following out, but I don&rsquo;t know if its necessary<br /></h2>

<h1 id="passdb-backend-tdbsam-br-3:591e5c02e74acd24649da083f0a88d90">passdb backend = tdbsam<br /></h1>

<p>obey pam restrictions = yes<br />
idmap uid = 10000-20000<br />
idmap gid = 10000-20000<br />
template shell = /bin/bash<br /></p>

<h1 id="note-i-do-not-use-the-separator-username-format-domain-user-br-3:591e5c02e74acd24649da083f0a88d90">Note: I do <em>not</em> use the separator username format: Domain\User<br /></h1>

<p>#winbind separator = &lsquo;\&rsquo;<br /></p>

<h1 id="the-following-allows-users-to-login-with-just-username-br-3:591e5c02e74acd24649da083f0a88d90">The following allows users to login with just Username<br /></h1>

<p>winbind use default domain = yes<br />
winbind enum users = yes<br />
winbind enum groups = ye template homedir = /home/%D/%U`</p>

<p><span style="font-weight: bold">/etc/krb5.conf</span> (from the <span style="font-style: italic">krb5-config</span> package)</p>

<p>``</p>

<p><span style="font-weight: bold">/etc/pam.d/common-auth</span></p>

<pre><code>  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-account&lt;/span&gt;
  
````I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
``I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
`` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-auth&lt;/span&gt;
  
```I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
``I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
`` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-auth&lt;/span&gt;
  
</code></pre>

<p><span style="font-weight: bold">/etc/pam.d/common-account</span></p>

<pre><code>  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-session&lt;/span&gt;
  
`````I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
``I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
`` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-auth&lt;/span&gt;
  
```I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
``I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
`` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-auth&lt;/span&gt;
  
``` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-account&lt;/span&gt;
  
````I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
``I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
`` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-auth&lt;/span&gt;
  
```I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
``I finally got it. After about 5 hours of working on it, I&amp;#8217;ve finally gotten **Linux to authenticate against Active Directory on a Windows 2000 Server**. I want to post how I have it configured because it seems like most documentation only takes you halfway.
  
Software used: [&lt;span style=&quot;font-weight: bold&quot;&gt;Debian&lt;/span&gt; Etch][1], [&lt;span style=&quot;font-weight: bold&quot;&gt;Samba&lt;/span&gt; 3.0.23c with &lt;span style=&quot;font-weight: bold&quot;&gt;Winbind&lt;/span&gt; and pam_winbind][2], and [&lt;span style=&quot;font-weight: bold&quot;&gt;MIT Kerberos&lt;/span&gt; with pam_libkrb5][3].

The first step after getting the prerequisite software installed is to &lt;span style=&quot;font-weight: bold&quot;&gt;join the domain&lt;/span&gt;. Luckily Samba has excellent documentation on how to join an Active Directory Domain. Specifically &lt;span class=&quot;sect2&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#id2574601&quot;&gt;On-the-Fly Creation of Machine Trust Accounts&lt;/a&gt; and &lt;/span&gt;&lt;span class=&quot;sect1&quot;&gt;&lt;a href=&quot;http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/domain-member.html#ads-member&quot;&gt;Samba ADS Domain Membership&lt;/a&gt;.&lt;/span&gt;

The next step is to hook Linux&amp;#8217;s authentication ([PAM][4]) into Active Directory. Here are the relevant bits of my configuration files:

&lt;span style=&quot;font-weight: bold&quot;&gt;NOTE:&lt;/span&gt; In the following examples &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT&lt;/span&gt; is the domain, &lt;span style=&quot;font-weight: bold&quot;&gt;TREMONT.LOCAL&lt;/span&gt; is the realm, and &lt;span style=&quot;font-weight: bold&quot;&gt;thsdc1&lt;/span&gt; is the Windows 2000 ADS (sometimes referred to as a PDC or Primary Domain Controller).

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/samba/smb.conf&lt;/span&gt; (relevant bits only)

`[global]&lt;br /&gt;
# Domain workgroup = Tremont realm = TREMONT.LOCAL security = ADS add machine script = /usr/sbin/useradd -d /var/lib/nobody -g 100 -s /bin/false -M %u&lt;br /&gt;
encrypt passwords = true&lt;br /&gt;
## Commented the following out, but I don't know if its necessary&lt;br /&gt;
# passdb backend = tdbsam&lt;br /&gt;
obey pam restrictions = yes&lt;br /&gt;
idmap uid = 10000-20000&lt;br /&gt;
idmap gid = 10000-20000&lt;br /&gt;
template shell = /bin/bash&lt;br /&gt;
# Note: I do *not* use the separator username format: Domain\User&lt;br /&gt;
#winbind separator = '\'&lt;br /&gt;
# The following allows users to login with just Username&lt;br /&gt;
winbind use default domain = yes&lt;br /&gt;
winbind enum users = yes&lt;br /&gt;
winbind enum groups = ye template homedir = /home/%D/%U`

&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/krb5.conf&lt;/span&gt; (from the &lt;span style=&quot;font-style: italic&quot;&gt;krb5-config&lt;/span&gt; package)
  
`` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-auth&lt;/span&gt;
  
``` 
  
&lt;span style=&quot;font-weight: bold&quot;&gt;/etc/pam.d/common-account&lt;/span&gt;
  
</code></pre>

<p><span style="font-weight: bold">/etc/pam.d/common-session</span></p>

<p>`````</p>

<ul>
<li><span style="font-weight: bold">Note 1:</span> Once you&#8217;re satisfied with your setup, remove &#8220;<span style="font-style: italic;">debug</span>&#8221; from the end of each line.</li>
<li><span style="font-weight: bold">Note 2:</span> <span style="font-style: italic; font-weight: bold">I have not setup </span><span style="font-weight: bold">/</span><span style="font-weight: bold">etc/pam.d/common-password</span> <span style="font-style: italic; font-weight: bold">so password changing will not affect the domain.</span></li>
<li><span style="font-weight: bold">Note 3:</span> Using <span style="font-weight: bold">pam_ldap</span> may be a better/easier way to integrate with Active Directory. I haven&#8217;t played with it, but there are <a href="http://www.oo-services.com/en/articles/sso.html">plenty</a> of [resources][6] talking about it.</li>
</ul>

<p><small>PS: How do you post code in WordPress without it borking all your newlines and causing much pain and suffering? Please <a href="mailto:michael@susens-schurter.com">let me know</a>.</small></p>

<p>[6]: <a href="http://adminspotting.net/articles/windows/Linux-and-Active-Directory.html">http://adminspotting.net/articles/windows/Linux-and-Active-Directory.html</a></p>

   </div>
 </div>


 <a href="https://twitter.com/share" class="twitter-share-button " data-size="small" data-count="none">Tweet</a>
 <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

 <ul class="pager">
      &nbsp;<li class="previous"><a href="https://blog.schmichael.com/2006/11/07/tremont-meets-tux/"> Tremont meets Tux</a></li>
      &nbsp;<li class="next"><a href="https://blog.schmichael.com/2006/11/05/installing-ubuntu-610-edgy-eft-on-a-dell-optiplex-gx620/"> Installing Ubuntu 6.10 Edgy Eft on a Dell Optiplex GX620</a></li>
</ul>



    </ul>
    </div>
    <footer>

        <p class="text-muted credit">&copy; . All rights reserved. </p>
    </footer>
 
    <script src="/js/jquery-1.10.2.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script type="text/javascript" src="/js/hc.js"></script>
</body>

</html>

